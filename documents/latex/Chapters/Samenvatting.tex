\begin{samenvatting}
\addchaptertocentry{\nederlandsesamenvatting}

\noindent Er zijn vele soorten gevaren op het internet, waaronder malware en DDOS aanvallen. Een netwerk kan beveiligd worden tegen zulke aanvallen met behulp van een intrusie detectie systeem. Een intrusie detectie systeem kan intrusies detecteren en genereert een alert wanneer het een intrusie detecteert. \\
\\
Deze intrusie detectie systemen bekijken een netwerken en analyseren alle trafiek. Voor grote datacenters wordt dit echter een zware taak. Er gaat enorm veel data doorheen het netwerk van een datacenter. Standaard intrusiesystemen kunnen het niet aan om dan alle trafiek volledig na te kijken. Een manier om dit op te lossen is door IP flows te gebruiken. Dit is geagregeerd van packet data. Het gebruiken van IP flows zorgt ervoor dat een intrusie detectie systeem alle trafiek kan nakijken. Hierbij treedt dan de vraag op ofdat via IP flows alle intrusies gedetecteerd kunnen worden. \\
\\
Intrusie detectie systemen vereisen ook veel manueel onderhoud. Hieraan hangt natuurlijk ook een hoge kost. Deze thesis tracht dan ook te bekijken ofdat een intrusie detectie systeem out-of-the-box een goede performance kan hebben. Dit wordt gedaan via machine learning algoritmes. Dit zijn algoritmes die kunnen leren van data en patronen kunnen herkennen. Dit lijkt goed toepasselijk voor het probleem van intrusie detectie, dit zal deze thesis ook bekijken, alsook welke algoritmes wel of niet werken. Een andere belangrijke vraag is natuurlijk ofdat zo een systeem ook toepasbaar is in een real-world scenario. 

\section{Intrusion detection systems}
Intrusie detectie systemen of IDS's kunnen intrusies detecteren op verschillende manieren. Een intrusie kan ook een aanval of een anomalie genoemd worden. Een intrusie detectie systeem kan ofwel het netwerk monitoren, ofwel systeem activiteiten monitoren. Een intrusie detectie systeem dat netwerkgedrag monitort wordt een netwerk-gebasseerd intrusie detectie systeem genoemd. Een intrusie detectiesysteem dat systeem activieiten monitort wordt een host-gebasseerd intrusie detectie systeem genoemd. Deze thesis implementeerd een netwerk-gebasseerd intrusie detectie systeem. \\
\\
Detectie kan gebeuren met behulp van twee methodes. De eerste methode is een signature-gebasseerde methode. Hierbij wordt een database bijgehouden waarin signatures zitten die aantonen hoe intrusies eruit zien. Het intrusie detectie systeem bekijkt dan telkens ofdat de signature van een packet of flow matched met een signature van de database. De andere methode is een anomalie-gebasseerde methode. Hierbij stelt het intrusie detectie systeem een statistisch model op wat normaal netwerkgedrag voorstelt. Alles wordt vergeleken met dit model en als er een afwijking opgemerkt wordt, wordt dit gezien als een intrusie.

\section{Attack classification}
Een intrusie detectie systeem kan intrusies detecteren. Om het intrusie detectie systeem efficienter te maken, moet exacte classificatie van een intrusie mogelijk zijn. Er wordt een onderscheid gemaakt tussen twee soorten intrusies. Er zijn interne en externe intrusies. Onder de externe intrusies behoren DDOS, Brute-force aanvallen, vulnerability scans, man in the middle attacks en buffer overflows. Interne intrusies kan ook malware genoemd worden. Er zijn verschillende soorten malware. Er zijn virusen, trojan horses, worms en botnets. \\
\\
Via IP flows kunnen niet alle soorten intrusies gedetecteerd worden. Meer bepaald, een intrusie detectie systeem dat IP flows gebruikt kan enkel DDOS, vulnerability scans, worms en botnets detecteren. Andere soorten aanvallen gebruiken niet zozeer netwerk communicatie. Echter kunnen er onder bepaalde omstandigheden toch andere intrusies gedetecteerd worden. Bijvoorbeeld, als er geweten is dat virussen altijd vanuit dezelfde bron verzonden worden, kan er toch geweten worden ofdat een flow hoogstwaarschijnlijk een virus bevat.

\section{IP Flows}
IP flows zijn geaggregeerd van alle packet data die door een netwerk gaan. Een flow is niet hetzelfde als een TCP connectie. Een flow wordt gezien als alle communicatie tussen twee apparaten. Flows worden geidentificeerd met een (source\_IP, destination\_IP, protocol) tuple. \\
\\
Niet alle intrusies kunnen gedetecteerd worden omdat flows geen informatie bevatten over de payload die in de flow voorkomt. Enkel het aantal paketten en het aantal bytes in de flow is gekend. Ook de source en destination poorten zijn gekend. De start tijd en de duratie van de flow worden ook bijgehouden. \\
\\
Een flow exporter is een programma dat flows opbouwd vanuit het netwerkverkeer. Sommige flow exporters staan ook toe extra informatie bij te houden in de flow. Bijvoorbeeld het aantal TCP SYNs in een flow kan bijgehouden worden. 

\section{Machine learning}
Machine learning vormt een subdomein binnen de Informatica. Het is een soort van Artificial Intelligence dat programma's toelaat om zelf te leren en patronen te herkennen in data. Leren betekent dat een algoritme data getoond moet worden. Dit algoritme gebruikt deze data om een model op te stellen waarmee het voorspellingen kan doen voor nieuwe data. \\
\\
Er zijn twee soorten machine learning algoritmes. Er zijn supervised learning algoritmes en unsupervised learning algoritmes. Supervised learning gebruikt trainingsdata die gelabeled is. In unsupervised learning moet het algoritme zelf structuur zoeken binnen de trainingsdata. \\
\\
Een machine learning algoritme probeert een proces te modelleren. Bijvoorbeeld, een machine learning algoritme kan gebruikt worden om te voorspellen wat het studiegeld volgend jaar gaat zijn. Een heel simpele manier om dit te doen is door het algoritme te leren wat de kost de afgelopen jaren was. Het algoritme stelt vervolgens een model op en tracht de kost voor volgend jaar te voorspellen gebasseerd op de data van de vorige jaren. \\
\\
Het model dat het algoritme opstelt word een hypothese genoemd. Om een proces te modeleren gebruikt een machine learning algoritme features van het te modeleren proces. Een feature kan alles zijn. In voorafgaand voorbeeld zijn de features, een jaartal en een kost: $(jaar, kost)$. \\
\\
De hypothese wordt wiskundig voorgesteld als een functie zoals: $H_0(x) = \theta_0 * x_0 + \theta_1 * x_1 + ... + \theta_n * x_n$. Hierbij zijn $(x_0, x_1, ..., x_n)$ de features. $(\theta_0, \theta_1, ..., \theta_n)$ zijn onbekendes. Hiervoor moet een goede waarde gevonden worden opdat de functie $H_0(x)$ een goede voorspelling kan doen. Dit gebeurt door een kost functie. Een kost functie berekend hoeveel de waarde van $H_0(x)$ en de eigenlijke waarde verschillen. Deze kost functie moet geminimaliseerd worden. In de thesis worden deze concepten dieper uitgelegd, alsook welke problemen er kunnen optreden en hoe ze opgelost kunnen worden\\
\\
Er kunnen verschillende soorten algoritmes gebruikt worden. De twee meest veelbelovende algoritmes zijn Support Vector Machines en K-Nearest Neighbors.  Support vector machines zijn een supervised learning algoritme. Het algoritme tracht om classificatie uit te voeren. Het tracht een goede opsplitsing te vinden tussen de verschillende klasses die vertegenwoordigd zijn in de trainingsdata. \\
\\
K-Nearest Neighbors is ook een supervised learning algoritme. De werking is echter wel ander dan Support Vector Machines. Support Vector Machines werken via de meer traditionele manier via een hypothese en kost functie. K-Nearest Neighbors of KNN doet dit niet.  Wanneer KNN een voorspelling moet uitvoeren op een data punt, wordt er gekeken welke $k$ datapunten vanuit de trainingsdata het dichtste liggen bij het te voorspellen datapunt. Er wordt dan gekeken welke klasse het meeste voorkomt in deze $k$ punten en dit is de voorspelling. \\
\\
Een belangrijk onderdeel is kijken hoe goed een algoritme werkt. Dit kan gedaan worden via precision P, recall R en de F-score. Deze concepter zijn simpel uit te leggen binnen binaire classificatie. Een datapunt is geklassificeerd als positive of negative. Een hoge precision stelt dat samples die geklassifiseerd zijn als positive ook eigenlijk positive zijn. Een hoge recall stelt dat samples die positive zijn ook geklassificeerd zijn als positive. De F-score is een berekening met de precision en recall: $(2 * P * R) / ( P + R)$. Hoe hoger deze score is, hoe beter het algoritme werkt.

\section{Implementatie}
In de implementatie is gebruik gemaakt van \textit{scikit-learn}. Dit is een robuuste  machine learning library voor Python. Het is gebouwd bovenop \textit{NumPy}, \textit{SciPy} en \textit{Matplotlib}. Deze library implementeerd de meeste algoritmes die besproken worden in deze thesis. Enkel neurale netwerken zijn niet ge\"implementeerd in deze library. \\
\\
De implementatie is opgebouwd uit verschillende modules. Hierdoor kunnen nieuwe componenten simpel toegevoegd worden. De eerste module is de machine learning module. Deze bevat alle machine learning algoritmes die gebruikt zijn. Er is ook een feature module. Deze module bevat klasses die gebruikt worden om features te verkrijgen uit de IP flows. \\
\\
Een loader module bevat alle klasses die nodig zijn om data te laden uit de verschillende data sets. De training module gebruikt de loaders en selecteert welke data gebruikt wordt om een algoritme mee te trainen. Een results module verkrijgt alle input en kan deze loggen of visualiseren.\\
\\
Om te bepalen welke modules gebruikt worden in de implementatie word een JSON config file gebruikt. Deze config file definieert welke modules gebruikt moeten worden alsook welke datasets gebruikt moeten worden. \\
\\
Er zijn vier verschillende datasets gebruikt. Elke dataset dient een ander doel. Twee datasets zijn gebruikt voor een machine learning algoritme te trainen op respectievelijk interne en externe intrusies. Deze datasets zijn ook gebruikt om te verifi\"eren dat het machine learning algoritme werkt via de F-score. De andere datasets zijn gebruikt om de machine learning algoritmes te testen op real-world data. \\
\\
De eerste dataset is de CTU-13 dataset. Dit is een gelabelde dataset die interne intrusies bevat. De klassificatie in deze dataset is zeer accuraat. Er zijn bijvoorbeeld labels voor botnets, google analytics en windows updates. De volgende dataset is de Tracelabel dataset. Deze dataset is ook gelabeld maar bevat externe intrusies. Ze is gemaakt op de Universiteit van Twente door een honeypot te plaatsen. Hierdoor bevat de dataset slechts een klein aantal normale flows die geen intrusies zijn.\\
\\
Er is een dataset verkregen van het EDM. Deze bevat ongelabelde data die gaat vanaf 18 Februari tot 24 maart 2016. Er is data van elke dag vanaf 10u tot 24u. Er is ook een dataset verkregen van Cegeka. Deze dataset gaat over drie dagen, van 3 April tot 5 April. Deze bevat ook firewall logs zodanig dat er gekeken kan worden ofdat de klassificatie correct gebeurt.\\
\\
Bijna alle attributen van een flow zijn gebruikt als features. Enkel de start tijd is niet gebruikt. Dit opdat de trainingdata niet genoeg data bevat over een een voldoende grote tijdsspanne. Alle features zijn als continue data voorgesteld. De meeste attributen van een flow zoals de IP adressen, aantal paketten en bytes zijn al continu, maar de source en destination poort, alsook het protocol is discrete data.\\
\\
De poorten zijn omgezet naar een feature die bekijkt ofdat de gebruikte poort een van de $1024$ veelgebruikte poorten is of niet. Voor elk protocol is een andere binaire feature gebruikt. 

\section{Evaluatie}
Om de machine learning algoritmes te evalueren, is er gebruik gemaakt van learning curves en de F-score. Er is tevens een baseline opgestelt om de machine learning algoritmes mee te vergelijken. Deze baseline is een algoritme dat willekeurig voorspellingen maakt. De learning curve is gebruikt om te bepalen ofdat bij het algoritme overfitting of underfitting optreedt. De F-score is gebruikt om de eigenlijke performance te meten.\\
\\
Tijdens de evaluatie zijn zowel supervised learning algoritmes als unsupervised learning algoritmes gebruikt. Bij de unsupervised learning algoritmes trad er het probleem op dat er moeilijk afgeleid kon worden ofdat de flow een intrusie was of niet. One-class Support Vector Machines, een unsupervised learning algoritme, kon niet met goede accuraatheid stellen of een flow een intrusie was of niet. Het was zelfs zo dat het amper beter werkte dan een compleet willekeurig algoritme.\\
\\
Supervised learning gaf veel betere resultaten. Er kon een goed evenwicht gevonden worden tussen precision en recall zodanig dat het syteem goed reageerde en niet teveel false positives gaf. Van de geteste supervised learning algoritmes is gevonden dat K-Nearest Neighbors de beste performance had. \\
\\
Er kan geconcludeerd worden dat IP flows gebruikt kunnen worden om intrusies te detecteren. Een flow-gebasseerd intrusie detectie systeem zou gebruikt kunnen worden als een van de eerste lagen van verdediging van een netwerk. Zodanig kan er al een grote filtering gebeuren op de inkomende data en kunnen al veel intrusies gedetecteerd worden. \\
\\
De machine learning algoritmes bleken goed te werken voor intrusie detectie systemen. Mits er goede trainingsdata beschikbaar is, kan een intrusie detectie systeem een goede performance behalen zonder manueel onderhoud. Ook zijn er goede resultaten behaald met de data van het EDM en van Cegeka. Dit toont aan dat het systeem ook in real-life scenario's gebruikt kan worden.

\end{samenvatting}